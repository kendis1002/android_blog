<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>3 lỗi cần phải tránh khi sử dụng Jetpack Compose</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/android_blog/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/android_blog/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/android_blog/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="Một nơi mà tôi và bạn có thể học Android cùng nhau" />
    <link rel="shortcut icon" href="/android_blog/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="/android_blog/3-mistakes-should-avoid-compose" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Kendis .dev" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="3 lỗi cần phải tránh khi sử dụng Jetpack Compose" />
    <meta property="og:description" content="Dưới đây sẽ là một số lỗi cần phải tránh khi sử dụng Jetpack Compose. Sử dụng scroll state value Hãy cùng xem xét ví dụ dưới đây: @Composable fun Mistake1() { val scrollState = rememberScrollState() Column ( modifier = Modifier() .fillMaxSize() .verticalScroll(scrollState) ) { for (i in 1..20) {" />
    <meta property="og:url" content="/android_blog/3-mistakes-should-avoid-compose" />
    <meta property="og:image" content="/android_blog/assets/images/viewmodelscope.png" />
    <meta property="article:publisher" content="https://www.facebook.com/kendis1002" />
    <meta property="article:author" content="https://www.facebook.com/kendis1002" />
    <meta property="article:published_time" content="2023-12-08T10:18:00+00:00" />
    <meta property="article:modified_time" content="2023-12-08T10:18:00+00:00" />
    <meta property="article:tag" content="Coroutine" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="3 lỗi cần phải tránh khi sử dụng Jetpack Compose" />
    <meta name="twitter:description" content="Dưới đây sẽ là một số lỗi cần phải tránh khi sử dụng Jetpack Compose. Sử dụng scroll state value Hãy cùng xem xét ví dụ dưới đây: @Composable fun Mistake1() { val scrollState = rememberScrollState() Column ( modifier = Modifier() .fillMaxSize() .verticalScroll(scrollState) ) { for (i in 1..20) {" />
    <meta name="twitter:url" content="/android_blog/" />
    <meta name="twitter:image" content="/android_blog/assets/images/viewmodelscope.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Kendis .dev" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Coroutine" />
    <meta name="twitter:site" content="@false" />
    <meta name="twitter:creator" content="@false" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Kendis .dev",
        "logo": "/android_blog/false"
    },
    "url": "/android_blog/3-mistakes-should-avoid-compose",
    "image": {
        "@type": "ImageObject",
        "url": "/android_blog/assets/images/viewmodelscope.png",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/android_blog/3-mistakes-should-avoid-compose"
    },
    "description": "Dưới đây sẽ là một số lỗi cần phải tránh khi sử dụng Jetpack Compose. Sử dụng scroll state value Hãy cùng xem xét ví dụ dưới đây: @Composable fun Mistake1() { val scrollState = rememberScrollState() Column ( modifier = Modifier() .fillMaxSize() .verticalScroll(scrollState) ) { for (i in 1..20) {"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="3 lỗi cần phải tránh khi sử dụng Jetpack Compose" href="/android_blog/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="/android_blog/">Kendis .dev</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/android_blog/">Trang chủ</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/android_blog/tag/architecture/">Architecture</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/android_blog/tag/coroutine/">Coroutine</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/android_blog/tag/hilt/">Hilt</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/android_blog/tag/compose/">Compose</a></li>
    <li class="nav-about" role="menuitem"><a href="/android_blog/about/">Tôi</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
                <a class="social-link social-link-fb" href="https://facebook.com/kendis1002" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Theo dõi</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-coroutine post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 8 December 2023"> 8 December 2023</time>
                </section>
                
                    
                        
                        <span class="post-card-tags">
                            <a href='/android_blog/tag/coroutine/' style="color:white;">COROUTINE</a>
                        </span>
                        
                    
                
                <h1 class="post-full-title">3 lỗi cần phải tránh khi sử dụng Jetpack Compose</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/android_blog/assets/images/viewmodelscope.png)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p>Dưới đây sẽ là một số lỗi cần phải tránh khi sử dụng <strong>Jetpack Compose</strong>.</p>

<h2 id="sử-dụng-scroll-state-value">Sử dụng scroll state value</h2>

<p>Hãy cùng xem xét ví dụ dưới đây:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">Mistake1</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">scrollState</span> <span class="p">=</span> <span class="nf">rememberScrollState</span><span class="p">()</span>
    <span class="nc">Column</span> <span class="p">(</span>
        <span class="n">modifier</span> <span class="p">=</span> <span class="nc">Modifier</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">fillMaxSize</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">verticalScroll</span><span class="p">(</span><span class="n">scrollState</span><span class="p">)</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">MyListItem</span><span class="p">(</span>
                <span class="n">scrolloffset</span> <span class="p">=</span> <span class="n">scrollState</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="nf">toFloat</span><span class="p">(),</span>
                <span class="n">modifier</span> <span class="p">=</span> <span class="nc">Modifier</span><span class="p">.</span><span class="nf">fillMaxwidth</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">MyListItem</span><span class="p">(</span>
    <span class="n">scrollOffset</span><span class="p">:</span> <span class="nc">Float</span><span class="p">,</span>
    <span class="n">modifier</span><span class="p">:</span> <span class="nc">Modifier</span> <span class="p">=</span> <span class="nc">Modifier</span><span class="p">()</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="nc">Text</span><span class="p">(</span>
        <span class="n">text</span> <span class="p">=</span> <span class="s">"Scroll item"</span><span class="p">,</span>
        <span class="n">modifier</span> <span class="p">=</span> <span class="n">modifier</span>
            <span class="p">.</span><span class="nf">padding</span> <span class="p">(</span><span class="mi">32</span><span class="p">.</span><span class="n">dp</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">graphicsLayer</span> <span class="p">{</span>
                <span class="n">translationX</span> <span class="p">=</span> <span class="n">scrollOffset</span>
            <span class="p">}</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Chỉ đơn giản là tạo 1 list các item có thể scroll được. Và khi scroll thì text sẽ di chuyển theo phương ngang. Thực ra đối với ví dụ trên thì sẽ không có thật ngoài thực tế đâu. Khi scroll thì item <code class="language-plaintext highlighter-rouge">MyListItem</code> sẽ di chuyển sang 2 bên.
Nhưng điều đáng nói ở đây là gì, lúc này, khi kiểm tra LayoutInspector và thực hiện scroll, ta thấy rằng <code class="language-plaintext highlighter-rouge">MyListItem</code> lại bị recomposing liên tục.</p>

<p>Đây là lý do phổ biến mà nhiều người phàn nàn về việc <strong>LazyColumn</strong> hay cả <strong>Scrollable</strong> view bị lag. Và lý do là sử dụng scroll state không đúng.</p>

<p>Quay lại code của chúng ta để tìm hiểu tại sao lại xảy ra vấn đề này và tìm cách giải quyết. Chúng ta đã tạo 1 state và truyền nó sang 1 sub-component là <code class="language-plaintext highlighter-rouge">MyListItem</code>. Mỗi lúc scrollState thay đổi thì <code class="language-plaintext highlighter-rouge">MyListItem</code> sẽ thay đổi bởi vì thực ra state truyền vào đã thay đổi rồi nên 1 compose như <code class="language-plaintext highlighter-rouge">MyListItem</code> biết là phải recompose lại.</p>

<p>Để sửa nó thì thay vì truyền scroll offset là 1 Float, chúng ta có thể truyền 1 lambda function, trả về Float và gọi lambda đó ở item. Ở compose cha thì ta sẽ thay state thành lambda luôn.</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">Mistake1</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">scrollState</span> <span class="p">=</span> <span class="nf">rememberScrollState</span><span class="p">()</span>
    <span class="nc">Column</span> <span class="p">(</span>
        <span class="n">modifier</span> <span class="p">=</span> <span class="nc">Modifier</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">fillMaxSize</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">verticalScroll</span><span class="p">(</span><span class="n">scrollState</span><span class="p">)</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">..</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">MyListItem</span><span class="p">(</span>
                <span class="n">scrolloffset</span> <span class="p">=</span> <span class="p">{</span> <span class="n">scrollState</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="nf">toFloat</span><span class="p">()</span> <span class="p">},</span>
                <span class="n">modifier</span> <span class="p">=</span> <span class="nc">Modifier</span><span class="p">.</span><span class="nf">fillMaxwidth</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">MyListItem</span><span class="p">(</span>
    <span class="n">scrollOffset</span><span class="p">:</span> <span class="p">()</span> <span class="p">-&gt;</span> <span class="nc">Float</span><span class="p">,</span>
    <span class="n">modifier</span><span class="p">:</span> <span class="nc">Modifier</span> <span class="p">=</span> <span class="nc">Modifier</span><span class="p">()</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="nc">Text</span><span class="p">(</span>
        <span class="n">text</span> <span class="p">=</span> <span class="s">"Scroll item"</span><span class="p">,</span>
        <span class="n">modifier</span> <span class="p">=</span> <span class="n">modifier</span>
            <span class="p">.</span><span class="nf">padding</span> <span class="p">(</span><span class="mi">32</span><span class="p">.</span><span class="n">dp</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">graphicsLayer</span> <span class="p">{</span>
                <span class="n">translationX</span> <span class="p">=</span> <span class="nf">scrollOffset</span><span class="p">()</span>
            <span class="p">}</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Thử lại xem, chúng ta đã không còn thấy các item bị recomposing khi scroll nữa. Lí do mà lambda có thể khắc phục vấn đề này là vì lambda khi được truyền qua các compose là reference, mà reference như thế thì không thay đổi. Mỗi lúc scroll thì lambda sẽ trả về giá trị offset cho <code class="language-plaintext highlighter-rouge">MyListItem</code>.</p>

<p>Vậy, mỗi lúc mà bạn sử dụng 1 state trực tiếp ở graphic layer, bạn phải check rằng không có sự recomposing không cần thiết ở đây.</p>

<h2 id="sử-dụng-compose-coroutine-scope-sai-cách">Sử dụng compose coroutine scope sai cách</h2>

<p>Hãy cùng xem xét ví dụ dưới đây:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">LoginScreen</span><span class="p">(</span>
    <span class="n">viewModel</span><span class="p">:</span> <span class="nc">MainViewModel</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">scope</span> <span class="p">=</span> <span class="nf">rememberCoroutineScope</span><span class="p">()</span>
    <span class="nc">Box</span> <span class="p">{</span> 
        <span class="nc">Button</span><span class="p">(</span>
            <span class="n">onClick</span> <span class="p">=</span> <span class="p">{</span>
                <span class="n">scope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
                    <span class="n">viewModel</span><span class="p">.</span><span class="nf">login</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">)</span> <span class="p">{</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Và viewModel mà chúng ta gọi tới:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">login</span><span class="p">()</span> <span class="p">{</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Điều chúng ta có ở đây là gì, một <code class="language-plaintext highlighter-rouge">rememberCoroutineScope</code> cung cấp 1 scope cho event <code class="language-plaintext highlighter-rouge">onClick</code> để gọi function login từ <code class="language-plaintext highlighter-rouge">viewModel</code>.</p>

<p>Vấn đề xảy ra ở đây là <code class="language-plaintext highlighter-rouge">scope</code> ở phía LoginScreen là UI Scope, nó có nghĩa là khi mà ta xoay màn hình hay là thay đổi config thì UI sẽ bị cancel, và nó tương ứng với việc login process sẽ luôn luôn bị cancel. Vậy thì thay vì tạo scope ở trong UI, hãy gọi scope ở trong viewModel. Chúng ta có 1 loại scope có sẵn đó là <code class="language-plaintext highlighter-rouge">viewModelScope</code>. Vậy thì cách mà chúng ta sẽ sửa nó sẽ là:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">LoginScreen</span><span class="p">(</span>
    <span class="n">viewModel</span><span class="p">:</span> <span class="nc">MainViewModel</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="nc">Box</span> <span class="p">{</span> 
        <span class="nc">Button</span><span class="p">(</span>
            <span class="n">onClick</span> <span class="p">=</span> <span class="p">{</span>
                <span class="n">viewModel</span><span class="p">.</span><span class="nf">login</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">)</span> <span class="p">{</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MainViewModel</span><span class="p">:</span> <span class="nc">ViewModel</span><span class="p">()</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">login</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">viewModelScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<blockquote>
  <p>Lưu ý: Chỉ có một vài trường hợp mà ta nên dùng <strong>UI scope</strong>:</p>
  <ol>
    <li>Đó là <strong>animation</strong>, các <strong>animation</strong> api thường làm việc với các <strong>suspend function</strong> và <strong>animation</strong> là không phải thứ cần được thực thi ở <strong>viewModel</strong>, chúng có thể thực hiện xong một cách trực tiếp trên UI và đối với <strong>animation</strong> thì người dùng luôn muốn nó đơn giản dừng và khởi tạo lại khi mà xoay màn hình.</li>
    <li>Thứ 2 là những thứ liên quan về việc show <strong>snack bar compose</strong>.</li>
  </ol>
</blockquote>

<h2 id="không-dùng-các-effect-handler">Không dùng các Effect Handler</h2>

<p>Trong coroutine chúng ta có hàng tá các <strong>effect handler</strong> khác nhau. Nhưng tôi thường xuyên thấy mọi người làm như thế này:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">LoginScreen</span><span class="p">(</span>
    <span class="n">isLoggedIn</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">,</span>
    <span class="n">navController</span><span class="p">:</span> <span class="nc">NavController</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">isLoggedIn</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">navController</span><span class="p">.</span><span class="nf">navigate</span><span class="p">(</span> <span class="n">route</span><span class="p">:</span> <span class="s">"main_screen"</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nc">Box</span> <span class="p">{</span> <span class="k">this</span><span class="p">:</span> <span class="nc">BoxScope</span>
        <span class="c1">// Content</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Họ sẽ có 1 compose state, check nó và sau đó họ thực hiện 1 điều gì nó như ví dụ trên là di chuyển màn hình.</p>

<blockquote>
  <p>Bất cứ điều gì bạn làm ở UI mà không phải là <strong>composable function</strong> thì bạn nên wrap chúng lại bằng các <strong>effect handler</strong>.</p>
</blockquote>

<p>Với ví dụ bên trên thì <code class="language-plaintext highlighter-rouge">navController.navigate( route: "main_screen")</code> không phải là 1 <strong>composable function</strong>. Trong hầu hết các trường hợp thì nó sẽ không sao nhưng mà đôi khi chúng ta không kiểm soát được lúc là <strong>composable function</strong> sẽ được recomposing nên sẽ có thể gây ra nhiều bug khá là kì cục bởi các side effects. Nên tốt nhất là cứ wrap chúng bằng <strong>effect handler</strong>.</p>

<p>Đây là đoạn code sau khi đã chỉnh sửa:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Composable</span>
<span class="k">fun</span> <span class="nf">LoginScreen</span><span class="p">(</span>
    <span class="n">isLoggedIn</span><span class="p">:</span> <span class="nc">Boolean</span><span class="p">,</span>
    <span class="n">navController</span><span class="p">:</span> <span class="nc">NavController</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="nc">LaunchEffect</span><span class="p">(</span><span class="n">key1</span> <span class="p">=</span> <span class="n">isLoggedIn</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">isLoggedIn</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">navController</span><span class="p">.</span><span class="nf">navigate</span><span class="p">(</span> <span class="n">route</span><span class="p">:</span> <span class="s">"main_screen"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nc">Box</span> <span class="p">{</span> <span class="k">this</span><span class="p">:</span> <span class="nc">BoxScope</span>
        <span class="c1">// Content</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="kết-luận">Kết luận</h2>

<p>Và trên tôi đã đề cập tới 3 lỗi mà mọi người thường hay mắc phải khi sử dụng <strong>Jetpack Compose</strong>. Trong quá trình làm việc, tôi sẽ cập nhật thêm về bài viết này.</p>

<p>Cảm ơn các bạn đã theo dõi.</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            
                <!-- <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to Kendis .dev</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

                </section> -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/android_blog/assets/images/ghost.png" alt="kendis" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/android_blog/author/kendis">Kendis</a></h4>
                                
                                    <p>Một thằng lập trình viên Android</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/android_blog/author/kendis">Read More</a>
                        </div>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/android_blog/assets/images/blog-cover.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; Kendis .dev &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/android_blog/tag/coroutine/">Coroutine</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/android_blog/better-way-to-collect-flow">Cách an toàn để thu thập các flow ở Android UI</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/android_blog/coroutinescope-application-hilt">Tạo 1 ứng dụng CoroutineScope sử dụng Hilt</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/android_blog/coroutines-cancellation-exceptions">Exception trong coroutine</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/android_blog/tag/coroutine/">
                                
                                    Xem tất cả 5 post  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/android_blog/coroutines-cancellation-exceptions">
                <div class="post-card-image" style="background-image: url(/android_blog/assets/images/coroutine-cancellation-exceptions.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/android_blog/coroutines-cancellation-exceptions">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Coroutine</span>
                            
                        
                    

                    <h2 class="post-card-title">Exception trong coroutine</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>Tất cả những điều bạn cần biết về exception trong coroutine

</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/android_blog/assets/images/ghost.png" alt="Kendis" />
                        
                        <span class="post-card-author">
                            <a href="/android_blog/author/kendis/">Kendis</a>
                        </span>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <span class="reading-time">
                    
                    
                      10 phút
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/android_blog/best-practices-for-coroutines-in-android">
                <div class="post-card-image" style="background-image: url(/android_blog/assets/images/viewmodelscope.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/android_blog/best-practices-for-coroutines-in-android">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Coroutine</span>
                            
                        
                    

                    <h2 class="post-card-title">Best practices về coroutine trong Android</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>Dưới đây sẽ là một số best practices có tác động tích cực bằng cách làm cho ứng dụng của bạn trở nên có khả năng mở rộng và test tốt hơn khi</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/android_blog/assets/images/ghost.png" alt="Kendis" />
                        
                        <span class="post-card-author">
                            <a href="/android_blog/author/kendis/">Kendis</a>
                        </span>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <span class="reading-time">
                    
                    
                      9 phút
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="/android_blog/">
            
                <img src="/android_blog/assets/images/favicon.png" alt="Kendis .dev icon" />
            
            <span>Kendis .dev</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">3 lỗi cần phải tránh khi sử dụng Jetpack Compose</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Chia sẻ <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=3+l%E1%BB%97i+c%E1%BA%A7n+ph%E1%BA%A3i+tr%C3%A1nh+khi+s%E1%BB%AD+d%E1%BB%A5ng+Jetpack+Compose&amp;url=https://kendis1002.github.io/android_blog/3-mistakes-should-avoid-compose"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://kendis1002.github.io/android_blog/3-mistakes-should-avoid-compose"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/android_blog/">Kendis .dev</a> &copy; 2025</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/android_blog/">Latest Posts</a>
                    <a href="https://facebook.com/kendis1002" target="_blank" rel="noopener">Facebook</a>
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                <h1 class="subscribe-overlay-title">Subscribe to Kendis .dev</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <!-- <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>
 -->
            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/android_blog/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/android_blog/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69281367-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
